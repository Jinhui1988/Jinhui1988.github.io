---
title: 关于线路科普和协议算法的发展
comments: true
abbrlink: 5ecf2a65
tags:
  - 科学上网 
  -  技术
  -  GFW
  -  线路科普
  -  IPLC
  -  VPN    
  -  翻墙

cover: https://206716-624220-raikfcquaxqncofqfm.stackpathdns.com/wp-content/uploads/2020/02/Shadowsocks.jpg
categories: 技术
date: 2021-11-27 16:31:53
toc:
---





## 开篇：

​     这个文章也是看了很多视频，尤其是AK的视频，记录了笔记，感觉他讲的挺专业的，也挺通俗易懂，所以就大致的知识点记录了下来，放到这上面也算是小复习了！ **注意： 本文只是探讨GFW的技术迭代以及各大运营商的线路知识科普和协议算法的发展，技术无罪！ 有其他需求请绕道！！谢谢！**   


## KXSW的方式：

​        三种模式：

- 软件：各类代理软件

- 硬件：硬路由软路由 （其实这两类也可以分开）

- 网关模式（比如就是CLASH里的Allow Lan（允许局域网连接））！

- 或者可以另外说：1.客户端；路由器；软路由！

  

## 线路的讲解：

- **CN2** (CHINA TELECOM NETX CARRIER NETWORK的缩写）：中国电信下一代承载网络，比**163骨干网**更通畅，搭载了**QOS**（Quaity of Service:服务质量，可以动态调节网络服务内容，保证网络的通畅性，有一种说法是被**QOS**,就是被**QOS**调整到低优先级，限了速）技术，主面向政企大客户，保证高质量的国际访问 !  **CN2**优点：**QOS**服务 ,缺点：价格非常高，包括（CN2GT （Global transit） CN2GIA（Global internet Access）! CN2GT更便宜些，拥堵程度一般，CN2GIA最贵最好，最稳定！ **注意的点：**有的小伙伴用了**CN2**，还是很慢，一个原因是被**QOS**，另一个就是你出口流量走的是**CN2**，回来流量可能走的还是**163骨干网**，所以买**CN2**线路时候，一定要搞清楚买的是**单向CN2**还是**双向CN2**, 有很多无良的服务提供商（**ISP**）！**干货**：很多游戏加速器其实用得就是有**QOS**的**CN2**线路，但具体走的是**GIA**还是**GT**，一般加速器厂商都不会直接告诉你，但是试用体验最好的加速器，一般都是比**CN2**优先级更高的线路！
- **BGP:** （**Border Gateway Protocol**的缩写：**边界网关协议**)，**BGP**机房一般叫**多线机房**，**BGP**机房可以自动识别你的线路是电信，联通还是移动，并且会自动使用最适合你连接服务器的线路，再你网络不通的时候，还会自动切换到其他线路来连接服务器，有些垃圾卖家为了节省成本，有一些冒牌的**BGP**机房，虽然也是多线接入，但是再线路故障的时候不会自动切换线路，需要人工介入！请注意！
- **GCP:** （谷歌云的缩写）
- **AWS:** （亚马逊的，**AMAZON WEB SERVICE**）
- **AZURE:** (微软家的服务)，这三个不是推荐给大部分人，各有各的问题和特点，比如**google**贵，**Azure**申请麻烦，亚马逊流量比较少，这三家不是针对国内市场做业务，针对的是全球，但敏感时期会抽风，不太稳定，**优点就是带宽大，可以换IP**，如果你是发烧友可以去实验）
- **PCCW:** 香港电讯盈科提供的，到大陆走的线路是**PCCW**自己接的直连，香港位置很好，很多**ISP**(网络服务提供商简称)会在香港这个位置租售主机，线路挺多，其中还有**HKT**, **HKBN**等，目前看**PCCW**是最好的，所以尽可能选择**PCCW**！
- **IPLC:** ( **International Private Leased Circuit** (国际私有租用线路，就是传说中的专线)，有两个非常牛逼的特点：**1.**价格奇贵，几千上万一个月，即使在供应商买了和别人合用，也是比别的线路贵很几倍以上，而且往往带宽小，流量低，这一点一定注意，很多标榜自己是IPLC线路的这些人，把很多东西做了隐性处理，他不明说，比如说带宽低，流量小，或者流量倍率高，大家在看到**IPLC**的时候一定稳住，里面水很深！ **2.** **IPLC**不过**GFW**审查，**IPLC**不过GFW，没有GFW不需要KXSW，之前说的游戏加速器线路，**IPLC**线路的游戏加速器效果是最好的，也是最贵的，有需求的朋友买加速器记得明确是不是IPLC线路了！**补充：**这期说的线路情况都是普遍情况，线路是很复杂的概念，搞明白线路大概问题后，一定要实测，以实测为准！
-  关于主机和线路的供应商，如果你不是特别专业，不要随便做推荐，最好的方式是自己通过学习相关的技术知识，自己去做判断和实验，然后挑选出适合自己的主机和线路，千万别像youtube一些无良博主的推荐，推荐的人多了，节点也就挂了，拥堵了，最好的方法就是学明白，自己来，自己测！还有就是自己搭建**VPS**不推荐，因木桶效应，考虑的问题太多，体验不好，买节点或者加速器最好！

## 关于协议的选择和其他..

VPS个人搭建的成本后续只会越来越高，还无人维护，不推荐！

**用VPS的人：**

- .写代码的，搞网络的，经常调试程序的，建站的，这些人可能涉及境外服务，自己搭建VPS来玩玩，顺便KXSW，出现问题有能力解决！
- 本职工作不是技术类，一帮发烧友！
- 他们自建VPS是为了搭建机场，卖给别人，有技术能力的，慢慢扩大，没有技术维护的，就关闭了，这里面有能力的是极少的，万中无一，什么阿猫阿狗都有，甚至还有现学现卖的
- 搭建只是为了KXSW，按教程一步一步做，也不懂相关技术知识，这部分人才是绝大部分人
- 如果要稳定，那么VPS的稳定性基本不存在，就算存在也只是暂时的！你要面临：**1.**接入线路的优化问题 ，**2.** **QOS**问题，**3.** **IP**被封锁问题, **4.** 敏感时期不能开机的问题, **5.** 协议和算法的加密和选择的问题, **6.** 流媒体的解锁，VPS的IP限制导致你只有唯一的一个地理位置可以用，想看多地区的节目，你需要多个地区的**VPS**,机场的话就随便选择，有几十个节点, **7.** 使用方面的便捷度，VPS如果倒了就懵圈了，机场节点死一半都没问题 ! 简而言之 , **VPS** 一旦出现问题，所有的环节需要你一个人搞定，机场可以理解为有几十上百个公共VPS同时授权你用，其中一个出现问题，你可以选择其他的，出现问题的线路也会有专人来处理 !

**选择机场注意的点：**测试的时候选在周末高峰期最具代表性，检测这家机场的实力！推荐**毒药**网站，测速的网站! **大机场永远是最稳定的** !

**协议的选择：** 所有协议都只有相对安全，没有绝对安全！在所有协议中，**shadowsocks** 协议，因为机制问题，目前还是体验最好，最简单，最快速，极度体现暴力美学的中转代理方式！同时，没有任何人能准确的告诉你shadowsocks协议已经被精确识别，判断并被封锁！这种风险存在，但原因是多维度的，**ss** 的安全性存在一定风险，但是目前依然是KXSW的主流方式！人工面临大数据是很无力的！ **trojan** 相比**V2RAY**，**特点1：** 协议变的更简单，只有一种websocket+tls，**另一个特点:** 就是执行加密解密算法比v2ray更快，是简化版的V2ray, 的确差不多是这样子！缺点就是定死了一个协议，其他协议就不支持了，弹性比较差， **还有一个特点：** trojan比较新，有些设备根本不能有相应的成熟的客户端能够使用！ 

**小结：** 

- 如果自建**VPS**，建议使用**V2RAY协议**，比**ss**更安全些！如果你对速度有更高点的要求，选择**trojan**就好，**trojan**虽然和**V2RAY**差不多，算是简化版本，但是速度比**V2RAY**更快!
- 如果是买的机场，就用**shadowsocks**协议，**ss协议**是没问题的，除非机场要故意赔钱，协议的选择是根据你的需求，部署环境，和使用习惯等因素挂钩的，因此没有最好的协议，学习网络知识的基础，掌握了相关技能后，动态的取舍才是最佳的KXSW方式!

## 非主流的KXSW

### VPN:

中国大部分用户可能还是用的**VPN**KXSW，可能得超过有50%，很吃惊…….**VPN**是广义的，很多游戏加速器可能就是用的**ss协议**，甚至一些**VPN**客户端也是可能用的**ss协议**，节点之类的，可以理解成**封闭的ss**，这些软件底层都不是**VPN**的通讯协议！这些用户的KXSW特点：1.看成人内容或者敏感内容，KXSW之后获取信息的方向非常窄!

目前主流的KXSW还是采用**socks5**代理的**ss**或者**ssr**，还有**V2RAY**和**trojan**，虽然从用户基数来说还是**VPN**用户占据主流，但是对长期和稳定的KXSW用户来说，**socks5**代理的方式才是目前最好的选择！ 但是这里提下，**VPN**对于**socks5**代理的方式从原理上讲有一定优势，那就是能实现真正意义上的全局代理，甚至一些socks5不转发的流量全部统统走代理，包括ICMP流量，VPN再网络层级中无限接近最底层，你可以理解为VPN建立了一个相当于虚拟网卡，你网络上的所有流量都会被强制接管，甚至再第三方眼中，你的IP都会变成VPN的服务器IP !  从**shadowsocks**到V2ray到Trojan，这都是SOCKS5代理，在网络层级中是在应用层的会话层，所以很多流量都无法代理，这就是为什么你开了**shadowsocks全局**，也不能通过代理打游戏 ! 接下来科普的是网络层级的知识！示例图看下：

![OSI模型](http://image1.bubuko.com/info/202010/20201002230911936890.png)

原理：这张图是**OSI模型**，解释了数据再各层级中的流动，一个数据在最上方的第七层应用层产生，到最后最底层物理网络接口发到互联网的挣个流程，大概就是这个样子的！ 这里拿在**google搜索**一个关键字这个实际的应用来举例，首先打开浏览器，输入关键字，在最上面的应用层，通过http协议发送到第六层表示层，表示层把收到的数据翻译成机器语言，发送到第五层会话层，会话层的作用是建立维护当前会话，接下来到第四层传输层，传输层的作用在于确定要使用的传输协议，并且添加对应的google服务器的通讯端口，然后到第三层网络层，数据到这里是为了添加**google**的IP地址，到了第二层数据链路层，在这里添加路由MAC地址，通讯对象的**MAC地址**等，最底层的就是物理层，数据以**比特流**的形式，最终通过你的网络硬件传输给google，google返回查询结果之后，发回数据，数据被接收后，是以相反的方向流动，就不啰嗦了！配合这个图，下面的东西就一目了然了:

- 网页浏览器，邮件服务器，文件传输这些都跑在应用层最上层
- 包括了**shadowsocks V2ray Trojan**等这种**socks5**类型的代理跑在第五层会话层，所以可以代理上面应用层的数据！游戏数据是直接通过传输层的协议**TCP**和**UDP**进行通讯的，所以不经过会话层，也不需要表示层来解释，所以**socks5**代理正常情况是不能加速游戏的！你打开KXSW软件，就算开了全局，也代理不了跑在传输层的游戏通讯数据!
- 包括ping trace等这些**ICMP指令**都跑在第三层网络层
- **VPN**跑在第二层数据链路层或者第三层网络层，所以**VPN**一大有点就是几乎所有流量都能被代理！**VPN=真全局**，但是**GFW**早都探测到VPN的特征，所以现在极不稳定，靠频繁更换**IP**来抵抗**GFW**!

###   Wireguard  :

​      是一个网络信息的安全专家搞出来的，设计原理就是为了加强安全性，对抗美国棱镜门计划，这个相比**VPN**有些特殊，**VPN**大都采用**TCP通讯协议**，而WG采用**UDP通讯协议**！

- **TCP:**  主要是需要本地和远程多次握手，建立长链接！并且验证每一次的通信，确保数据按照顺序到达和处理！但**TCP**容易被**GFW**通过发送**Reset包**来阻断!
- **UDP:**  不管对面有没有再听，我就发数据包，而且不建立长链接，也没哟牛通过数据戳来验证数据包的完整性和顺序性的机制，你可以理解为：**TCP**是两个正常的人之间的对话，**UDP**是一个瞎子对另一个人乱喊乱叫，数据包也会经常丢，都是乱序到达，**GFW**发送**Reset包**对**UDP**不起作用，所以也就无法封锁WG! 但是**UDP流量**被**QOS**限速是极为普遍的情况，原因就是WG的特征非常明显，所以WG不适合KXSW，也不应该用于KXSW，就算能用，也仅仅是因为小众，**GFW**懒得鸟你，所以不推荐，其他**VPN**也是这样！但是，同时对于不想麻烦的小白，可能**VPN**更加便捷！这也是这么多人用**VPN**的原因吧！

                            

##  关于安全:

​       没做笔记，用于学习的话没有人管你，查了一下统计中国KXSW用户大概**几百万到2000万之间**，所以也不是一个小数目了！抱着学习的目的，没有人说你，何况很多人还会去查学术资料的！所以，**看自己!** 

      
